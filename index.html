<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fitness Tracker App</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; margin: 0; max-width: 800px; margin: auto; transition: background 0.3s, color 0.3s; }
    input, button, select { width: 100%; padding: 8px; margin: 5px 0; box-sizing: border-box; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
    canvas { margin-top: 30px; max-width: 100%; }
    .tabs { display: flex; margin-bottom: 20px; }
    .tab { flex: 1; padding: 10px; text-align: center; background: #eee; cursor: pointer; border: 1px solid #ccc; }
    .tab.active { background: #ddd; font-weight: bold; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .export-btn, .toggle-btn, .float-btn { background-color: #007bff; color: white; border: none; cursor: pointer; margin-top: 10px; }
    .dark-mode { background-color: #121212; color: #f0f0f0; }
    .dark-mode table, .dark-mode th, .dark-mode td { border-color: #555; }
    .highlight-pr { background-color: #ffeeba !important; }
    .float-btn { position: fixed; bottom: 20px; right: 20px; padding: 15px; border-radius: 50%; font-size: 20px; }
    #loginContainer { max-width: 400px; margin: auto; padding-top: 50px; }
    #appContainer { display: none; }
    @media (max-width: 600px) {
      th, td { font-size: 12px; padding: 6px; }
    }
  </style>
</head>
<body>

<div id="loginContainer">
  <h2>Login to your Tracker</h2>
  <input type="text" id="username" placeholder="Enter username">
  <button onclick="login()">Login</button>
</div>

<div id="appContainer">
  <h1>Fitness Tracker (<span id="userDisplay"></span>)</h1>
  <button class="toggle-btn" onclick="toggleDarkMode()">Toggle Dark Mode</button>

  <div class="tabs">
    <div class="tab active" onclick="showTab('logTab')">Training Log</div>
    <div class="tab" onclick="showTab('weightTab')">Bodyweight</div>
    <div class="tab" onclick="showTab('cardioTab')">Cardio</div>
  </div>

  <!-- Training Log Tab Content -->
  <div id="logTab" class="tab-content active">
    <h2>Resistance Exercise Log</h2>
    <input type="text" id="exercise" placeholder="Exercise">
    <input type="number" id="sets" placeholder="Sets" min="1">
    <input type="number" id="reps" placeholder="Reps" min="1">
    <input type="number" id="weight" placeholder="Weight (kg)" min="0">
    <input type="number" id="goal" placeholder="Target Weight (kg)">
    <button onclick="addLogEntry()">Add to Log</button>
    <table>
      <thead><tr><th>Exercise</th><th>Sets</th><th>Reps</th><th>Weight</th><th>Date</th><th>Goal Progress</th></tr></thead>
      <tbody id="logBody"></tbody>
    </table>
  </div>

  <!-- Bodyweight Tab Content -->
  <div id="weightTab" class="tab-content">
    <h2>Bodyweight Tracker</h2>
    <input type="number" id="bodyweight" placeholder="Weight (kg)" min="0">
    <button onclick="addWeightEntry()">Add Weight</button>
    <table>
      <thead><tr><th>Date</th><th>Weight (kg)</th></tr></thead>
      <tbody id="weightBody"></tbody>
    </table>
  </div>

  <!-- Cardio Tab Content -->
  <div id="cardioTab" class="tab-content">
    <h2>Cardio Tracker</h2>
    <input type="text" id="cardioType" placeholder="Type (e.g. Running, Cycling)">
    <input type="number" id="cardioDuration" placeholder="Duration (minutes)" min="0">
    <input type="number" id="cardioDistance" placeholder="Distance (km)" min="0">
    <input type="text" id="cardioNotes" placeholder="Notes (optional)">
    <button onclick="addCardioEntry()">Add Cardio</button>
    <table>
      <thead><tr><th>Date</th><th>Type</th><th>Duration (min)</th><th>Distance (km)</th><th>Notes</th></tr></thead>
      <tbody id="cardioBody"></tbody>
    </table>
  </div>
</div>

<script>
  let currentUser = null;

  function login() {
    const username = document.getElementById("username").value.trim();
    if (!username) return alert("Please enter a username.");
    currentUser = username;
    localStorage.setItem("fitnessAppUser", username);
    document.getElementById("userDisplay").textContent = username;
    document.getElementById("loginContainer").style.display = "none";
    document.getElementById("appContainer").style.display = "block";
    initApp();
  }

  function showTab(tabId) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
    document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add('active');
    document.getElementById(tabId).classList.add('active');
  }

  function initApp() {
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark-mode');
    }
    renderLog?.();
    updateLogChart?.();
    renderWeights?.();
    updateWeightChart?.();
    renderCardio();
  }

  function addCardioEntry() {
    const type = document.getElementById("cardioType").value;
    const duration = +document.getElementById("cardioDuration").value;
    const distance = +document.getElementById("cardioDistance").value;
    const notes = document.getElementById("cardioNotes").value;
    const date = new Date().toISOString().split('T')[0];
    if (!type || !duration || !distance) return alert("Please fill in all required fields.");
    const log = JSON.parse(localStorage.getItem(`cardioLog_${currentUser}`)) || [];
    log.push({ date, type, duration, distance, notes });
    localStorage.setItem(`cardioLog_${currentUser}`, JSON.stringify(log));
    renderCardio();
  }

  function renderCardio() {
    const log = JSON.parse(localStorage.getItem(`cardioLog_${currentUser}`)) || [];
    const body = document.getElementById("cardioBody");
    body.innerHTML = '';
    log.forEach(entry => {
      body.innerHTML += `<tr><td>${entry.date}</td><td>${entry.type}</td><td>${entry.duration}</td><td>${entry.distance}</td><td>${entry.notes || ''}</td></tr>`;
    });
  }

  window.onload = () => {
    const savedUser = localStorage.getItem("fitnessAppUser");
    if (savedUser) {
      currentUser = savedUser;
      document.getElementById("userDisplay").textContent = savedUser;
      document.getElementById("loginContainer").style.display = "none";
      document.getElementById("appContainer").style.display = "block";
      initApp();
    }
  }
</script>

</body>
</html>
